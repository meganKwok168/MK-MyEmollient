<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=, initial-scale=1.0">
    <title>Quiz</title>
</head>
<style>

    .slideActive {
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center; 
        height: 80vh;
    }
    .slide{
        display: none;
    }

    .cell-container {
        display: flex;
        flex-wrap: wrap;
        max-width: 1200px;
        margin: 0 auto;
        width: 100%;
    }

    .cell, .descriptCell {
        flex: 0 0 50%;
        box-sizing: border-box;
        /* padding: 10px; */
}

    .descript{
        padding-left: 5vw;
        padding-right: 5vw;
        line-height: 30px;
        text-align: left;
    }

    .imgs {
        width: 100%;
        position: relative;
    }

    .imgs img {
        width: 100%;
        height: auto;
        display: block;
        object-fit: cover;
    }

    .un {
        position: relative;
        z-index: 1;
    }

    .deux {
        position: absolute;
        top: 0;
        left: 0;
        opacity: 0;
        transition: opacity 0.3s ease;
        z-index: 2;
    }

    .imgs:hover .deux {
        opacity: 1;
    }

    .overlay-btn {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        
        background-color: white;
        color: black;
        text-decoration: none;
        padding: 12px 32px;
        font-size: 16px;
        font-weight: 500;
        letter-spacing: 0.15em;
        text-transform: uppercase;

        border: none;
        border-radius: 0;
        box-shadow: none;
        
        z-index: 3;
        transition: background-color 0.3s ease, color 0.3s ease;
    }

    .overlay-btn:hover {
        background-color: black;
        color: white;
    }



    .name{
        text-decoration: none;
        color: white;
        font-size: 40px;
        /* font-weight: bold; */

    }

    .descriptCell{
        background-color: #3c3c3c;
        color: white;
        display: flex;
        flex-direction: column;
        justify-content: center; /* vertical centering */
        align-items: center;     /* horizontal centering */
        padding: 20px;   
        text-align: center;
    }

    .name:visited {
        color: white;
    }

    /* Responsive stacking */
    @media (max-width: 768px) {

        .cell, .descriptCell {
            flex: 0 0 100%;  /* full width */
        }

        .descriptCell {
            padding-left: 5vw;   /* optional: keep some padding */
            padding-right: 5vw;
            height: 100vw;  /* so that the description box will still be a square */
        }
    }


    /* Hide native radio/checkbox */
input[type="radio"],
input[type="checkbox"] {
    display: none;
}

.question-text {
    font-size: 1.3rem;
    margin-bottom: 15px;
    text-align: center;
    padding: 15px;
    width: 50vw;
    color: white;
}

.options {
    display: flex;
    flex-wrap: wrap;
    gap: 15px;
    justify-content: center;
    max-width: 60vw;
    margin: 0 auto;
}

.option-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    background-color:rgb(38, 45, 38);
    color: white;
    padding: 12px 25px;
    /* border-radius: 8px; */
    border: 1px solid white;
    /* height: 5vh; */
    cursor: pointer;
    transition: all 0.2s ease-in-out;
    font-family: inherit;
    text-align: center;
    width: 20vw;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.9); 
    font-size: 14px;
}

.option-btn:hover {
    background-color: rgba(114,125,101,82);
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.5); 
}

/* Selected state */
input[type="radio"]:checked + .option-btn,
input[type="checkbox"]:checked + .option-btn {
    background-color:  rgba(114,125,101,82);
    color: white;
    border: 2px solid white;
}

.buttons {
    display: flex;              
    justify-content: center;      
    align-items: center;         
    gap: 20px;                  
    padding-top: 5vh;
}


.prevNextButtons {
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 0px;
    height: 5vh;
    min-width: 8vh;
    padding: 0 12px;
    border: none;
    background-color:  rgb(238,238,238)  ;
    color: black;
    cursor: pointer;
    font-family: inherit;
    font-size: 14px;
    text-align: center;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
    transition: all 0.2s ease-in-out;
}

.prevNextButtons:hover {
    background-color: rgb(114,125,101);
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.5);
    color: black;
}

.prevNextButtons:disabled {
    background-color: rgba(238,238,238,70) ;
    cursor: not-allowed;
    box-shadow: none;
    color: black;
}

.wholeThing{
    display: none;
    background-image: url('https://cdn.shopify.com/s/files/1/0331/1412/8521/files/leavesEdited.jpg?v=1758323266') !important;
    background-size: cover;
}
.display{
    padding: 5px;
    /* border: 10px solid rgb(114,125,101); */
}

@media (max-width: 768px) {

    /* Question text takes full width */
    .question-text {
        font-size: 1rem;
        width: 90vw;
        padding: 10px;
    }

    .options {
        gap: 8px;       
        justify-content: center;
    }

    .option-btn {
        width: 40%;          /* smaller horizontal size so two fit per row */
        padding: 8px 10px;   /* less padding so they donâ€™t feel oversized */
        font-size: 10px;   /* shrink text a little */
    }

    .buttons {
        flex-wrap: nowrap;      /* keep them side by side */
        gap: 10px;              /* smaller gap between them */
    }

    .prevNextButtons {
        min-width: 20vw;        /* remove the fixed minimum */
        width: 40%;             /* shrink width so two fit side by side */
        padding: 8px 0;         /* less padding */
        font-size: 10px;      /* smaller text */
        
    }

    /* Product display */
    .cell-container {
        flex-direction: column;
        max-width: 100%;
    }

    .cell, .descriptCell {
        flex: 0 0 100%;
        width: 100%;
        text-align: center;
        padding: 15px;
    }

    .descript {
        padding: 0 20px;
        line-height: 1.4;
        font-size: 13px;
    }

    .name {
        font-size: 1.5rem;
    }

    .overlay-btn {
        font-size: 14px;
        padding: 10px 20px;
    }
}

/* Starting Screen Layout */
.starting {
    display: flex;
    max-width: 100vw;
    height: 100vh;
}

.startingImg {
    max-width: 50vw;
    height: 100vh;
    flex-shrink: 0;
}

.startingImg img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.startingDescript {
    max-width: 50vw;
    height: 100vh;
    display: flex;
    flex-direction: column; /* stack text + button */
    justify-content: center; /* center vertically */
    align-items: center; /* align text to left side */
    padding: 0 5vw;
    background-color: rgb(51, 56, 51);
    color: white;
}

.startingDescriptText {
    max-width: 50vw;
    font-size: 35px;
    margin-bottom: 20px;
    text-align: center;
}

.startingOverlayBtn {
    background-color: rgb(51, 56, 51);
    color: white;
    text-decoration: none;
    padding: 15px 35px;
    font-size: 16px;
    font-weight: 500;
    letter-spacing: 0.1em;
    text-transform: uppercase;
    border: none;
    border: 2px solid white;
    cursor: pointer;
    transition: all 0.3s ease;
}

.startingOverlayBtn:hover {
    background-color: white;
    color: black;
}

@media (max-width: 768px) {
    .starting {
        flex-direction: column; /* stack vertically */
        max-width: 100vw;           /* ensure full width */
        height: auto;
        margin: 0;              /* remove default margins */
        padding: 0;
    }

    .startingImg, .startingDescript {
        max-width: 100vw;            /* full width */
        height: auto;           /* half screen height each */
        flex-shrink: 0;
    }

    .startingImg img {
        min-width: 100%;            /* image stretches full width */
        height: 100%;           /* image fills container height */
        object-fit: cover;      /* maintain aspect ratio & cover */
        display: block;         /* remove inline spacing */
    }

    .startingDescript {
        min-height: 40vh;
        max-width: 100vw;
        padding: 2vw 5vw;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        text-align: center;
    }

    .startingDescriptText {
        font-size: 18px;
        margin-bottom: 15px;
    }

    .startingOverlayBtn {
        padding: 12px 25px;
        font-size: 14px;
    }
}





</style>
<body>
<div class="starting" id="starting">
    <div class="startingImg">
        <img src="https://cdn.shopify.com/s/files/1/0331/1412/8521/files/EMOLLIENT_c12482e3-a6dd-4462-97dc-ded808c7e1af.png?v=1756227966" alt="Body Butter">
    </div>
    <div class="startingDescript">
        <p class="startingDescriptText">Which body butter is best for you?</p>
        <button class="startingOverlayBtn" id="startingOverlayBtn">TAKE THIS ONE MINUTE SKIN SURVEY!!</button>
    </div>
</div>



    <div class="wholeThing" id="wholeThing">
        <div id="display" class="display"></div>
    </div>
</body>
</html>

<script>

document.getElementById("startingOverlayBtn").addEventListener("click", function(e){
    e.preventDefault();   // stop default anchor behavior
    document.getElementById("starting").style.display = "none";  // hide starting screen
    document.getElementById("wholeThing").style.display = "block";  // show quiz
});

    //question modes
let all_that_apply = 0;
let choose_one = 1;


const questions = [
    {
        "question": "How would you describe your skin? (Choose all that apply)",
        "answers": [
            "Dry", 
            "Sensitive", 
            "Flaky", 
            "Itchy", 
            "Rough", 
            "Ashy", 
            "None"],
        "question_mode": all_that_apply
    },
    {
        "question": "Do you have any specific issues you would like to address?",
        "answers": [
            "Eczema", 
            "Psoriasis", 
            "Stretch Marks", 
            "Cracked Heels", 
            "Skin Elasticity", 
            "Dark Spots", 
            "Muscle Tension", 
            "Hot Flashes", 
            "Overheating", 
            "Sunburns",          
            "None"],
        "question_mode": all_that_apply
    },
    {
        "question": "How is your sleep?",
        "answers": [
            "I have trouble falling alseep at night.",
            "I wish I had more energy in the mornings.",
            "No complaints!"
        ],
        "question_mode": choose_one
    },
    {
        "question": "What's your relationship to fitness?",
        "answers": [
            "I'm passionate about staying fit through exercise.",
            "I love to hike and stay active by doing outdoor activities.",
            "I get my steps in by traveling to new destinations.",
            "I'm a homebody."
        ],
        "question_mode": choose_one
    },
    {
        "question": "What kind of mood do you prefer?",
        "answers": [
            "Refreshing",
            "Calming",
            "Grounding",
            "Warm & comforting",
            "Clean & simple", //unscented and sensitive skin        
        ],
        "question_mode": choose_one
    }
]

const products = [
    {
        "name": "Lemon + Sage Body Butter ",
        "link": "https://myemollient.com/collections/lemon-sage",
        "imgUn": "https://myemollient.com/cdn/shop/files/Lemon_Sage_Body_Butter_for_Dry_Skin_and_Ec_1296x.jpg?v=1728704501",
        "imgDeux": "https://myemollient.com/cdn/shop/files/lemon_and_sage_body_butter_1296x.jpg?v=1728519251",
        "descript": "Infused with essential oils of lemon and sage, this butter not only pampers your skin but also envelops you in a rich, uplifting fragrance, providing a comforting experience with every use.",
        "choices": [
            {
                "question": 1,
                "answer": 5,
                "score": 1
            },
            {
                "question": 1,
                "answer": 5,
                "score": 1
            },
            {
                "question": 2,
                "answer": 1,
                "score": 1
            },
            {
                "question": 3,
                "answer": 0,
                "score": 1
            },
            {
                "question": 4,
                "answer": 2,
                "score": 3
            },
        ]
    },

    {
        "name": "Lavender Body Butter",
        "link": "https://myemollient.com/collections/lavender-body-butter",
        "imgUn": "https://myemollient.com/cdn/shop/files/handmade-lavender-body-butter_2700x.jpg?v=1747099010",
        "imgDeux": "https://myemollient.com/cdn/shop/products/my-emollient-dry-skin-solution_2700x.jpg?v=1747099010",
        "descript": "Experience the best body butter for dry, sensitive, and eczema-prone skin.",
        "choices": [
            {
                "question": 2,
                "answer": 0,
                "score": 1
            },
            {
                "question": 4,
                "answer": 1,
                "score": 3
            }
        ]
        
    },
    {
        "name": "Almond + Vanilla Body Butter",
        "link": "https://myemollient.com/collections/almond-vanilla-body-butter",
        "imgUn": "https://myemollient.com/cdn/shop/files/almond-vanilla-body-butter-orgnanic-moisturizer_1296x.jpg?v=1747415007",
        "imgDeux": "https://myemollient.com/cdn/shop/files/almond-vanilla-body-butter-jar-mango-butter-almonds_2700x.jpg?v=1755053852",
        "descript": "Experience the ultimate in moisture with our handcrafted Almond + Vanilla Whipped Body Butterâ€”a rich, non-greasy formula made with 7 skin-loving ingredients. ",
        "choices": [
            {
                "question": 1,
                "answer": 2,
                "score": 1
            },
            {
                "question": 4,
                "answer": 3,
                "score": 3
            }
        ]
    },
    {
        "name": "Body Butter for Sensitive Skin",
        "link": "https://myemollient.com/collections/body-butter-for-sensitive-skin",
        "imgUn": "https://myemollient.com/cdn/shop/files/body_butter_for_sensitive_skin_and_eczema_1296x.jpg?v=1729980179",
        "imgDeux": "https://myemollient.com/cdn/shop/files/sensitive-skin-body-butter-with-kokum-and-aloe._2700x.jpg?v=1755053048",
        "descript": "This lightly scented body butter is crafted for those with sensitive skin who need a little extra careâ€”including those managing dry patches or prone to eczema.",
        "choices": [
            {
                "question": 0,
                "answer": 1,
                "score": 2
            },
            {
                "question": 0,
                "answer": 2,
                "score": 1
            },
            {
                "question": 0,
                "answer": 3,
                "score": 1
            },
            {
                "question": 1,
                "answer": 0,
                "score": 10
            },
            {
                "question": 1,
                "answer": 9,
                "score": 1
            },
            {
                "question": 4,
                "answer": 3,
                "score": 1
            },
            {
                "question": 4,
                "answer": 4,
                "score": 1
            }
        ]
    },
    {
        "name": "Unscented Body Butter",
        "link": "https://myemollient.com/collections/unscented",
        "imgUn": "https://myemollient.com/cdn/shop/files/Unscented_Body_Butter_for_Winter_Dry_Skin_1296x.jpg?v=1737604260",
        "imgDeux": "https://myemollient.com/cdn/shop/files/best-body-butter-dry-skin-jar-closed_1296x.jpg?v=1747158292",
        "descript": "No Fragrance.  No Fluff. Just powerful hydration for even the most sensitive skin.",
        "choices": [
            {
                "question": 0,
                "answer": 1,
                "score": 1
            },
            {
                "question": 0,
                "answer": 2,
                "score": 1
            },
            {
                "question": 0,
                "answer": 3,
                "score": 1
            },
            {
                "question": 1,
                "answer": 0,
                "score": 10
            },
            {
                "question": 1,
                "answer": 1,
                "score": 10
            }
        ]        
    },
    {
        "name": "Peppermint Body Butter",
        "link": "https://myemollient.com/collections/peppermint-body-butter",
        "imgUn": "https://myemollient.com/cdn/shop/files/Peppermint_body_butter_for_eczema_dry_skin_menopause_and_hot_flashes_1296x.jpg?v=1750775986",
        "imgDeux": "https://myemollient.com/cdn/shop/files/peppermint-butter-post-workout-recovery_1296x.jpg?v=1755051005",
        "descript": "Crafted for dry, menopausal, and sensitive skin (including skin that's easily irritated or eczema-prone), the peppermint-infused formula delivers a crisp, cooling sensation while locking in long-lasting moisture.",
        "choices": [
            {
                "question": 1,
                "answer": 3,
                "score": 1
            },
            {
                "question": 1,
                "answer": 6,
                "score": 1
            },
            {
                "question": 1,
                "answer": 7,
                "score": 10
            },
            {
                "question": 2,
                "answer": 1,
                "score": 1
            },
            {
                "question": 3,
                "answer": 0,
                "score": 1
            },
            {
                "question": 4,
                "answer": 0,
                "score": 3
            }
        ]  
    },
    {
        "name": "Jet Lag Set",
        "link": "",
        "imgUn": "",
        "imgDeux": "",
        "descript": "description",
        "choices": [
            {
                "question": 3,
                "answer": 2,
                "score": 3
            }
        ]        
    },
    {
        "name": "Eczema",
        "link": "",
        "imgUn": "",
        "imgDeux": "",
        "descript": "description",
        "choices": [
            {
                "question": 1,
                "answer": 0,
                "score": 1
            },
            {
                "question": 1,
                "answer": 1,
                "score": 1
            }
        ]
    }
]


function makeForm(){
    
    st = `<br><form id="slideshowForm">`; //start string
    
    for (let q = 0; q < questions.length; q++){ //iterate through questions
    
        if (q == 0){
            st+=  `<div class="slideActive" id="q${q}">`;
        }
        else{
            st+=  `<div class="slide" id="q${q}">`;
        }
        st += `<p class="question-text">${questions[q].question}</p>`; //quesiton
         st+= `<div class="options">`
        for (let a = 0; a < questions[q].answers.length; a++){
            let inputMode = ``;
            if (questions[q].question_mode == all_that_apply){
                inputMode = `checkbox`;
            } 
            else {
                inputMode = `radio`;
            }
            st+=`<input type = "${inputMode}" 
                id="q${q}a${a}" value="${questions[q].answers[a]}" name="q${q}">
                <label class="option-btn" for="q${q}a${a}">${questions[q].answers[a]}</label>`;
        }
            

        st += `</div>   </div> <br>`;
    }

    st+=`   
    </form>`;

    document.getElementById("display").innerHTML = st; //insert code into HTML
}


let currentSlide = 0;

function makeButtons(){
    let nextButtonCode = ``;
    if (currentSlide == questions.length-1){ //if currentSlide is last slide
        nextButtonCode = `<button type="submit" class="prevNextButtons" id="submitButton">Submit</button>`;
    }
    else{
        nextButtonCode = `<button type="button" class="prevNextButtons" id="nextButton" onclick="changeSlide(1)">Next</button>`;
    }
    let prevButtonCode = ``;
    if (currentSlide == 0){ //if currentSlide is first slide
        prevButtonCode = `disabled="disabled"`      //disable prevButton
    }
        if (document.getElementById(`q${currentSlide}`).innerHTML.includes(`<div class="buttons">
                <button type="button" class="prevNextButtons"`)) {
            document.getElementById("buttons").remove();    //remove any previous buttons
        }
        document.getElementById(`q${currentSlide}`).insertAdjacentHTML(
            'beforeend',
            `<div class="buttons">
                <button type="button" class="prevNextButtons" id="prevButton" onclick="changeSlide(-1)" ${prevButtonCode}>Back</button>
                ${nextButtonCode}
            </div>`
        );

    document.getElementById("slideshowForm").addEventListener("submit", function(e){
        e.preventDefault();
        //processing data===============================
        let formData = new FormData(slideshowForm);
        let formValuesList = []
        for (let [key, value] of formData.entries()) {
            formValuesList.push({ name: key, value: value });
        }
        //call function for making result and input processed data
        makeResult(formValuesList);
    })
}

function changeSlide(n){
    document.getElementById(`q${currentSlide}`).className = "slide";
    currentSlide += n;
    document.getElementById(`q${currentSlide}`).className="slideActive"
    makeButtons();
}

function makeResult(formValues) {
    console.log(formValues);
    let questionBeingChecked = questions[4].answers[4]
    let q4Answer = formValues.find(f => f.name === "q4")?.value;
    if (q4Answer == questionBeingChecked){
        let st = ``;
        butters = [products[3], products[4]]
        for (butter of butters){
            st += `
            <div class="cell-container" style="length: 30vh">
                <div class="cell">
                    <div class="imgs">
                        <a href=${butter.link}>
                            <img class="un" src=${butter.imgUn} alt="">
                            <img class="deux" src=${butter.imgDeux} alt="">
                            <a href=${butter.link} class="overlay-btn">SHOP CLEAN</a>
                        </a>
                    </div>
                </div>
                <div class="descriptCell">
                    <a class="name" href=${butter.link}>${butter.name}</a>
                    <br>
                    <p class="descript">${butter.descript}</p>
                </div>
            </div>
            <br>
            `;
        }
        document.getElementById("display").innerHTML = st;
    }
    else{
        let butter = null;
        let highestScore = 0;
        for (let product of products) {
            let score = 0;
            for (let choice of product.choices) {
                let choiceText = questions[choice.question].answers[choice.answer];
                for (let formValue of formValues) {
                    if (formValue.value === choiceText) {
                        score += choice.score; // add the score
                    }
                }
            }
            if (score > highestScore) {
                highestScore = score;
                butter = product;
            }
        }

        // display result
        if (butter != null) {
            let st = `
            <div class="cell-container">
                <div class="cell">
                    <div class="imgs">
                        <a href=${butter.link}>
                            <img class="un" src=${butter.imgUn} alt="">
                            <img class="deux" src=${butter.imgDeux} alt="">
                            <a href=${butter.link} class="overlay-btn">SHOP CLEAN</a>
                        </a>
                    </div>
                </div>
                <div class="descriptCell">
                    <a class="name" href=${butter.link}>${butter.name}</a>
                    <br>
                    <p class="descript">${butter.descript}</p>
                </div>
            </div>`;
            document.getElementById("display").innerHTML = st;
        }
    }

}

makeForm();
makeButtons();

</script>